# Dataset Splitter

Инструмент для разделения наборов данных на тренировочную и валидационную выборки с сохранением парности изображений и их меток.

## Описание

Данный скрипт перемещает случайно выбранный процент файлов из исходной директории в директорию назначения, сохраняя связь между изображениями и их метками. Это особенно полезно при подготовке данных для обучения моделей компьютерного зрения, когда необходимо создать отдельные наборы для тренировки и валидации.

## Требования

- Python 3.6+
- OpenCV (cv2)
- PyYAML
- tqdm

## Установка

1. Клонируйте репозиторий или скачайте файлы проекта:
```bash
git clone <url-репозитория>
cd <директория-проекта>
```

2. Установите необходимые зависимости:
```bash
pip install opencv-python pyyaml tqdm
```

## Структура файлов

Проект включает следующие файлы:
- `config.yaml` - файл конфигурации
- `split_dataset.py` - основной скрипт разделения данных
- `utils.py` - вспомогательные функции

## Конфигурация

Настройка скрипта осуществляется через файл `config.yaml`:

```yaml
path_in: "/путь/к/исходному/датасету"
path_out: "/путь/к/выходной/директории"
transfer_percentage: 0.06  # процент данных для перемещения (от 0 до 1)
```

### Требования к структуре данных

Исходная директория должна иметь следующую структуру:
```
путь_к_исходным_данным/
├── classes.txt (опционально)
├── images/
│   ├── file1.jpg
│   ├── file2.jpg
│   └── ...
└── labels/
    ├── file1.txt
    ├── file2.txt
    └── ...
```

Важно: имена файлов изображений и их меток должны совпадать (за исключением расширений).

## Использование

1. Настройте параметры в файле `config.yaml`
2. Запустите скрипт:
```bash
python split_dataset.py
```

Скрипт выполнит следующие действия:
- Проверит наличие соответствующих пар файлов (изображение + метка)
- Выберет случайным образом указанный процент данных
- Переместит выбранные пары файлов в директорию назначения
- Создаст структуру директорий в выходной папке, если они не существуют
- Проверит, что все изображения могут быть корректно открыты

## Пример использования

1. Создайте файл конфигурации `config.yaml`:
```yaml
path_in: "/home/user/datasets/plates_dataset"
path_out: "/home/user/datasets/plates_validation"
transfer_percentage: 0.1
```

2. Запустите скрипт:
```bash
python split_dataset.py
```

3. После завершения, 10% данных будут перемещены в директорию `/home/user/datasets/plates_validation`, а 90% останутся в исходной директории.

## Возможные проблемы и их решение

- **Сообщение "difference is: [...]"**: Означает, что некоторые файлы не имеют соответствующей пары (изображение или метка). Проверьте наличие всех необходимых файлов.
- **Сообщение "not_oppened_imgs: [...]"**: Перечисляет изображения, которые не удалось открыть с помощью OpenCV. Возможно, эти файлы повреждены или имеют неподдерживаемый формат.

## Примечание

Данный скрипт перемещает файлы из исходной директории, а не копирует их. Если вы хотите сохранить оригинальные данные, предварительно создайте резервную копию.