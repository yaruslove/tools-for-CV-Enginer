# YOLO Dataset Splitter

Скрипт для разбивки YOLO датасета на train/val выборки с приоритетом по количеству разметки.

## Описание

Этот инструмент автоматически разбивает YOLO датасет на обучающую (train) и валидационную (val) выборки, отдавая приоритет изображениям с наибольшим количеством объектов разметки.

### Ключевые особенности:

- **Приоритет по объему разметки**: Сначала отбираются изображения с наибольшим количеством размеченных объектов (определяется по размеру .txt файлов)
- **Автоматическое создание структуры**: Создает правильную структуру папок для YOLO
- **Проверка целостности**: Убеждается, что для каждого изображения есть соответствующий файл разметки
- **Гибкая конфигурация**: Настройки через YAML файл

## Структура данных

### Входные данные (src_data):
```
src_data/
├── images/
│   ├── image1.jpg
│   ├── image2.png
│   └── ...
└── labels/
    ├── image1.txt
    ├── image2.txt
    └── ...
```

### Выходные данные (dst_data):
```
dst_data/
├── train/
│   ├── images/
│   │   ├── image1.jpg
│   │   └── ...
│   └── labels/
│       ├── image1.txt
│       └── ...
└── val/
    ├── images/
    │   ├── image5.jpg
    │   └── ...
    └── labels/
        ├── image5.txt
        └── ...
```

## Установка

1. Клонируйте или скачайте файлы
2. Установите зависимости:
```bash
pip install pyyaml
```

## Использование

1. Настройте `config.yaml` согласно вашим требованиям
2. Запустите скрипт:
```bash
python yolo_splitter.py
```

## Алгоритм работы

1. **Чтение конфигурации** из `config.yaml`
2. **Сбор пар изображение-лейбл** из исходных папок
3. **Сортировка по размеру файлов разметки** (по убыванию)
4. **Создание структуры папок** назначения
5. **Копирование файлов**:
   - Первые N пар с наибольшей разметкой → train
   - Следующие M пар → val

## Поддерживаемые форматы

**Изображения**: .jpg, .jpeg, .png, .bmp, .tiff, .tif
**Разметка**: .txt (формат YOLO)

## Требования

- Python 3.6+
- PyYAML
- Достаточно свободного места на диске
- Корректная структура исходных данных

## Примеры использования

### Пример 1: Малый датасет
```yaml
src_data: /home/user/my_dataset
dst_data: /home/user/split_dataset
train: 80
val: 20
```

### Пример 2: Большой датасет
```yaml
src_data: /data/large_yolo_dataset
dst_data: /data/train_ready
train: 8000
val: 2000
```

## Обработка ошибок

Скрипт проверяет:
- Существование исходных папок images и labels
- Наличие достаточного количества пар изображение-лейбл
- Корректность структуры файлов

## Логирование

Скрипт выводит:
- Статистику найденных пар
- Топ-5 файлов с наибольшей разметкой
- Прогресс копирования
- Итоговую статистику

## Примечания

- Файлы копируются, а не перемещаются (исходные данные остаются нетронутыми)
- Если файл разметки пустой (0 байт), он все равно будет учтен, но с низким приоритетом
- Имена файлов изображений и разметки должны совпадать (кроме расширения)

## Автор

Скрипт для автоматизации подготовки YOLO датасетов к обучению.