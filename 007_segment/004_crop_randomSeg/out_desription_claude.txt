I'll create a script that generates random crops from input images with segmentation masks of varying shapes.

Я создал скрипт для генерации случайных кропов изображений с нерегулярными сегментационными масками, согласно вашему запросу. Вот как он работает:

### Функциональность скрипта:

1. **Генерация случайных кропов:**
   - Берет изображения из директории `src_imgs`
   - Для каждого изображения создает `numbCropp_PerImage` случайных кропов
   - Размер каждого кропа выбирается случайно в диапазоне от `min_size` до `max_size`

2. **Сегментационные маски:**
   - Создает четыре типа масок с разной вероятностью:
     - Неровный круг (60% вероятность) - наиболее частый
     - Неровный овал (20% вероятность)
     - Полумесяц (10% вероятность)
     - Случайный сегмент произвольной формы (10% вероятность)

3. **Обработка краев:**
   - Применяет серию эрозий и дилатаций с случайными структурирующими элементами
   - Это создает "лесенку" по краям фигуры, делая их неровными и пиксельными

4. **Прозрачность:**
   - Сохраняет результат в PNG с прозрачным фоном вне маски

### Как использовать:

1. Создайте YAML-конфигурационный файл:
   ```yaml
   src_imgs: "/путь/к/исходным/изображениям"
   dst_cropp: "/путь/куда/сохранять/кропы"
   numbCropp_PerImage: 5  # Количество кропов на изображение
   min_size: [64, 64]  # Минимальный размер (ширина, высота)
   max_size: [256, 256]  # Максимальный размер (ширина, высота)
   ```

2. Запустите скрипт:
   ```
   python random_crop_segmenter.py config.yaml
   ```

### Особенности реализации:

- **Вариативность форм:** Созданы различные функции для генерации разных типов сегментационных масок
- **Пиксельные края:** Реализовано с помощью морфологических операций
- **Прогресс-бар:** Скрипт показывает прогресс обработки с помощью библиотеки tqdm
- **Обработка ошибок:** Проверки на случай, если изображение слишком маленькое для заданного минимального размера

Дополнительные зависимости, которые потребуются:
- OpenCV (cv2)
- NumPy
- SciPy (для морфологических операций)
- PyYAML (для работы с конфигурационным файлом)
- tqdm (для отображения прогресса)

Скрипт можно расширить или модифицировать в зависимости от ваших конкретных требований.